<!DOCTYPE html>
<html lang="en"
      xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
</head>
<body>
<h3>결제 취소 신청폼</h3>
    <form name="cancel" action="javascript:void(0)" method="POST">
        <div>
            <label for="orderId">주문번호</label>
            <input type="text" name="orderId" id="orderId" readonly>  <!--환불 진행할 상품의 해당 주문번호-->
        </div>
        <div>
            <label for="totalPrice">환불 금액</label>
            <input type="number" name="totalPrice" id="totalPrice" readonly>  <!--환불 금액-->
        </div>
        <div>
            <label for="reason">환불 사유</label>
            <input type="text" name="reason" id="reason" readonly>  <!--환불 사유-->
        </div>
        <button name="submitBtn" type="submit" onclick="cancelPayments()">환불하기</button>
    </form>
        <button id="closeBtn" >닫기</button>
<script th:inline="javascript">
    const forms = document.forms.cancel;
    console.log(forms)
    async function cancelPayments(){
        const forms = document.forms.cancel;
        const formData = new FormData(forms);
        let url = "/refund/admin/payments/cancel.do";
        const resp = await fetch(url,{method: "POST", body: formData})
        console.log("$$$$resp: "+ resp)
        const respJson = await resp.json();
        console.log("$$$$respJson: "+respJson)

    }

    let closeBtn = document.querySelector("#closeBtn");
    closeBtn.addEventListener("click",()=>{
        window.close();
    })

</script>
</body>
</html>